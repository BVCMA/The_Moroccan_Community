<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Moroccan Community | Expert Financial Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #d4af37; --dark: #020617; --card: #0f172a; }
        body { font-family: 'Inter', sans-serif; background-color: var(--dark); color: #f8fafc; }
        .font-brand { font-family: 'Cinzel', serif; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .page-view { display: none; min-height: 90vh; }
        .page-view.active { display: block; animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .input-pro { background: #1e293b; border: 1px solid #334155; padding: 12px; border-radius: 8px; width: 100%; color: white; outline: none; transition: 0.3s; }
        .input-pro:focus { border-color: var(--gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.2); }
        .btn-gold { background: var(--gold); color: black; font-weight: 700; padding: 12px 24px; border-radius: 8px; transition: 0.3s; }
        .btn-gold:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); }
        .sidebar-link { padding: 12px; border-radius: 8px; cursor: pointer; transition: 0.2s; font-size: 0.8rem; display: block; margin-bottom: 5px; }
        .sidebar-link:hover { background: rgba(212, 175, 55, 0.1); color: var(--gold); }
    </style>
</head>
<body>

    <nav class="glass sticky top-0 z-[100] border-b border-white/5">
        <div class="max-w-7xl mx-auto px-6 h-20 flex justify-between items-center">
            <h1 class="font-brand text-xl cursor-pointer" onclick="showView('home')">THE MOROCCAN <span class="text-amber-500">COMMUNITY</span></h1>
            <div class="hidden md:flex space-x-8 text-[11px] font-bold uppercase tracking-widest">
                <button onclick="showView('home')" class="hover:text-amber-500">Accueil</button>
                <div class="relative group">
                    <button class="text-amber-500">Simulateurs Pro ▼</button>
                    <div class="absolute hidden group-hover:block top-full left-0 w-56 bg-slate-900 border border-slate-700 p-2 rounded shadow-2xl">
                        <a onclick="showView('sim-dcf')" class="sidebar-link">Analyse de Valeur (DCF)</a>
                        <a onclick="showView('sim-immo')" class="sidebar-link">Simulateur Crédit Immo</a>
                        <a onclick="showView('sim-pea')" class="sidebar-link">Optimiseur Fiscal PEA</a>
                        <a onclick="showView('sim-gearing')" class="sidebar-link">Solvabilité (Gearing)</a>
                        <a onclick="showView('sim-yield')" class="sidebar-link">Rendement Dividendes</a>
                        <a onclick="showView('sim-retraite')" class="sidebar-link">Planification Retraite</a>
                    </div>
                </div>
                <button onclick="showView('academy')" class="hover:text-amber-500">Académie</button>
                <button onclick="showView('contact')" class="bg-amber-500 text-black px-4 py-2 rounded">Contact</button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-10">

        <section id="home" class="page-view active">
            <div class="grid lg:grid-cols-2 gap-12 items-center py-16">
                <div>
                    <span class="text-gold font-bold tracking-widest text-xs uppercase">Plateforme Certifiée pour Analystes</span>
                    <h2 class="font-brand text-5xl md:text-7xl mt-4 mb-6 leading-tight">L'Engineering Financier au <span class="text-gold italic">Maroc</span></h2>
                    <p class="text-slate-400 text-lg mb-8">Accédez à des outils de calcul haute précision pour la Bourse de Casablanca et la gestion de patrimoine d'entreprise. </p>
                    <div class="flex gap-4">
                        <button onclick="showView('sim-dcf')" class="btn-gold">Lancer l'Analyse</button>
                        <button onclick="showView('academy')" class="border border-slate-700 px-6 py-3 rounded-lg font-bold">Consulter les Cours</button>
                    </div>
                </div>
                <div class="relative">
                    <div class="glass p-8 rounded-[2rem] border-gold/20 relative z-10">
                        <div class="flex justify-between mb-4">
                            <span class="text-xs font-mono text-gold">MAROC ALL SHARES INDEX</span>
                            <span class="text-xs font-mono text-green-400">+12.4% YTD</span>
                        </div>
                        <canvas id="homeMiniChart" height="200"></canvas>
                    </div>
                    <div class="absolute -top-10 -right-10 w-64 h-64 bg-gold/10 blur-[100px] -z-0"></div>
                </div>
            </div>

            <div class="py-20 border-t border-white/5">
                <h3 class="font-brand text-3xl text-center mb-12">Foire aux <span class="text-gold">Questions</span></h3>
                <div class="max-w-3xl mx-auto grid gap-4">
                    <details class="glass p-6 rounded-2xl group cursor-pointer">
                        <summary class="font-bold flex justify-between">Comment sont calculés les taux d'actualisation ? <span class="text-gold">+</span></summary>
                        <p class="text-sm text-slate-400 mt-4">Nous utilisons le modèle CAPM (MEDAF) adapté au risque souverain du Maroc, avec une prime de risque marché ajustée trimestriellement.</p>
                    </details>
                    <details class="glass p-6 rounded-2xl group cursor-pointer">
                        <summary class="font-bold flex justify-between">Le simulateur PEA inclut-il la réforme fiscale ? <span class="text-gold">+</span></summary>
                        <p class="text-sm text-slate-400 mt-4">Oui, l'optimiseur prend en compte l'exonération totale d'impôt sur le revenu après une période de conservation de 5 ans.</p>
                    </details>
                </div>
            </div>
        </section>

        <section id="sim-dcf" class="page-view">
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="glass p-8 rounded-3xl">
                    <h3 class="font-brand text-xl text-gold mb-6">Paramètres DCF</h3>
                    <div class="space-y-4">
                        <div><label class="text-[10px] uppercase font-bold text-slate-500">Cash Flow Année 0 (MAD)</label>
                        <input id="dcf-cf" type="number" value="1000000" class="input-pro"></div>
                        <div><label class="text-[10px] uppercase font-bold text-slate-500">Taux de Croissance (g) %</label>
                        <input id="dcf-g" type="number" value="5" class="input-pro"></div>
                        <div><label class="text-[10px] uppercase font-bold text-slate-500">WACC %</label>
                        <input id="dcf-wacc" type="number" value="9" class="input-pro"></div>
                        <button onclick="runDcf()" class="w-full btn-gold mt-4">Calculer la Valeur</button>
                    </div>
                </div>
                <div class="lg:col-span-2 space-y-8">
                    <div class="glass p-8 rounded-3xl">
                        <canvas id="chartDcf" height="300"></canvas>
                    </div>
                    <div class="glass p-8 rounded-3xl border-l-4 border-gold">
                        <h4 class="font-bold text-gold mb-2 uppercase text-xs">Rapport d'Analyse Intrinsèque</h4>
                        <div id="reportDcf" class="text-sm text-slate-300 italic">Entrez vos données pour générer le constat...</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="sim-immo" class="page-view">
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="glass p-8 rounded-3xl">
                    <h3 class="font-brand text-xl text-gold mb-6">Crédit Immobilier</h3>
                    <div class="space-y-4">
                        <input id="immo-capital" type="number" placeholder="Montant du prêt (MAD)" class="input-pro">
                        <input id="immo-taux" type="number" placeholder="Taux d'intérêt (%)" class="input-pro">
                        <input id="immo-duree" type="number" placeholder="Durée (années)" class="input-pro">
                        <button onclick="runImmo()" class="w-full btn-gold">Générer l'Échéancier</button>
                    </div>
                </div>
                <div class="lg:col-span-2 glass p-8 rounded-3xl">
                    <div class="flex justify-between items-center mb-8">
                        <div>
                            <p class="text-xs text-slate-500 uppercase">Mensualité Estimée</p>
                            <h2 id="res-immo-mensu" class="text-4xl font-bold text-white">0 MAD</h2>
                        </div>
                        <div class="text-right">
                            <p class="text-xs text-slate-500 uppercase">Coût Total du Crédit</p>
                            <h2 id="res-immo-total" class="text-xl font-bold text-red-400">0 MAD</h2>
                        </div>
                    </div>
                    <canvas id="chartImmo" height="250"></canvas>
                    <div id="reportImmo" class="mt-6 text-sm text-slate-400 border-t border-white/5 pt-4"></div>
                </div>
            </div>
        </section>

        <section id="sim-pea" class="page-view">
            <div class="max-w-4xl mx-auto glass p-12 rounded-[3rem] text-center">
                <h2 class="font-brand text-3xl text-gold mb-8">Optimiseur de Portefeuille PEA</h2>
                <div class="grid md:grid-cols-2 gap-8 text-left">
                    <div class="space-y-4">
                        <input id="pea-cap" type="number" placeholder="Capital Initial (MAD)" class="input-pro">
                        <input id="pea-prof" type="number" placeholder="Profit espéré (%)" class="input-pro">
                        <button onclick="runPea()" class="w-full btn-gold">Simuler la Fiscalité</button>
                    </div>
                    <div class="bg-slate-900/50 p-6 rounded-2xl">
                        <h4 class="text-xs font-bold text-gold uppercase mb-4">Constat Fiscal</h4>
                        <div id="res-pea-eco" class="text-3xl font-bold text-green-400 mb-2">0 MAD</div>
                        <p class="text-[10px] text-slate-500 italic">Économie réalisée par rapport au Compte Titres classique grâce à l'abattement de 100% après 5 ans au Maroc.</p>
                    </div>
                </div>
            </div>
         </section>

    </main>

    <script>
        // NAVIGATION ENGINE
        function showView(id) {
            document.querySelectorAll('.page-view').forEach(v => v.classList.remove('active'));
            const target = document.getElementById(id);
            if(target) {
                target.classList.add('active');
                window.scrollTo(0,0);
            } else {
                alert("Ce module est en cours de développement.");
            }
        }

        // CHARTS HELPERS
        let charts = {};

        function createChart(id, type, labels, data, label) {
            const ctx = document.getElementById(id).getContext('2d');
            if(charts[id]) charts[id].destroy();
            charts[id] = new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        borderColor: '#d4af37',
                        backgroundColor: 'rgba(212, 175, 55, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }

        // DCF LOGIC
        function runDcf() {
            const cf = parseFloat(document.getElementById('dcf-cf').value);
            const g = parseFloat(document.getElementById('dcf-g').value) / 100;
            const wacc = parseFloat(document.getElementById('dcf-wacc').value) / 100;
            
            let years = [1, 2, 3, 4, 5];
            let cfs = years.map(y => cf * Math.pow(1 + g, y));
            const tv = (cfs[4] * 1.02) / (wacc - 0.02);
            const ev = tv / Math.pow(1 + wacc, 5);

            createChart('chartDcf', 'line', ['Année 1', 'Année 2', 'Année 3', 'Année 4', 'Année 5'], cfs, 'Cash Flow Projeté (MAD)');
            
            document.getElementById('reportDcf').innerHTML = `
                <b>Constat :</b> Avec un taux d'actualisation de ${(wacc*100).toFixed(1)}%, la valeur terminale est estimée à <b>${Math.round(tv).toLocaleString()} MAD</b>. 
                Si la capitalisation actuelle du titre est inférieure à ${Math.round(ev).toLocaleString()} MAD, le titre présente une marge de sécurité.
            `;
        }

        // IMMO LOGIC
        function runImmo() {
            const capital = parseFloat(document.getElementById('immo-capital').value);
            const taux = (parseFloat(document.getElementById('immo-taux').value) / 100) / 12;
            const duree = parseFloat(document.getElementById('immo-duree').value) * 12;

            const mensu = (capital * taux) / (1 - Math.pow(1 + taux, -duree));
            const total = (mensu * duree) - capital;

            document.getElementById('res-immo-mensu').innerText = Math.round(mensu).toLocaleString() + " MAD";
            document.getElementById('res-immo-total').innerText = Math.round(total).toLocaleString() + " MAD";

            createChart('chartImmo', 'bar', ['Capital Emprunté', 'Intérêts Totaux'], [capital, total], 'Structure du Crédit');
            
            document.getElementById('reportImmo').innerHTML = `<b>Analyse :</b> Pour un salaire net recommandé de ${Math.round(mensu/0.4).toLocaleString()} MAD. Le coût des intérêts représente ${(total/capital*100).toFixed(1)}% de la somme empruntée.`;
        }

        // PEA LOGIC
        function runPea() {
            const cap = parseFloat(document.getElementById('pea-cap').value);
            const prof = parseFloat(document.getElementById('pea-prof').value) / 100;
            const gain = cap * prof;
            const eco = gain * 0.15; // Économie taxe dividendes/plus-value
            document.getElementById('res-pea-eco').innerText = Math.round(eco).toLocaleString() + " MAD";
        }

        // HOME CHART INIT
        window.onload = () => {
            createChart('homeMiniChart', 'line', ['Jan', 'Fev', 'Mar', 'Avr', 'Mai'], [12000, 12400, 13100, 12900, 14200], 'MASI Index');
        };
    </script>
</body>
</html>
